<!doctype html>
<html>
<head>
<title>Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" type="text/css" href="index.css"/>
  <script type="text/javascript" src="roslite.bundle.js"></script>
  <script type="text/javascript" src="imuNode.js"></script>
  <script type="text/javascript" src="gpsNode.js"></script>
</head>
<body>

<div id="imuDisplay"></div>
<div id="gpsDisplay"></div>

<script>
// "rostopic echo /gps/fix"
(()=>{
  let nh = ros.initNode("echo_gps");
  let onData = (msg) => {
    console.log("recevied gps message:", msg);
    print("Received GPS message:", "#0080cc");
    gpsDisplay.innerHTML = json2html(msg);
  };
  nh.subscribe("/gps/fix", "sensor_msgs/NavSatFix", onData);
})();

// "rostopic echo /imu/data"
(()=>{
  let nh = ros.initNode("echo_imu");
  let onData = (msg) => {
    console.log("recevied imu message:", msg);
    print("Received IMU message:", "#0080cc");
    imuDisplay.innerHTML = json2html(msg);
  };
  nh.subscribe("/imu/data", "sensor_msgs/Imu", onData);
})();

let json2html = function(msg) {
    return JSON.stringify(msg, null, 2).replace(/\n/sg, "<br>").replace(/ /sg, "&nbsp;");
}

</script>

</body>
</html>
